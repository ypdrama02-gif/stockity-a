<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stockity AI Pro - Auto Trader</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f172a; color: #e5e7eb; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .app { width: 100%; max-width: 450px; padding: 15px; }
        .box { background: #1e293b; border-radius: 12px; padding: 15px; margin-bottom: 10px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border: 1px solid #334155; }
        .header { text-align: center; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
        .signal { font-size: 32px; font-weight: bold; text-align: center; padding: 20px; border-radius: 10px; transition: all 0.3s; }
        .status-bar { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px; }
        .btn-start { width: 100%; padding: 12px; background: #2563eb; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-start:hover { background: #1d4ed8; }
        .log-box { background: #020617; color: #10b981; font-family: 'Courier New', Courier, monospace; font-size: 11px; height: 120px; overflow-y: auto; padding: 10px; border-radius: 8px; margin-top: 10px; border: 1px solid #1e293b; }
        canvas { width: 100%; height: 100px; margin-top: 10px; }
        .indicator-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; margin-top: 10px; }
        .ind-item { background: #334155; padding: 5px; border-radius: 4px; text-align: center; }
    </style>
</head>
<body>

<div class="app">
    <div class="box header">
        <h2 style="margin:0; color:#3b82f6;">STOCKITY AI v2.0</h2>
        <div style="font-size: 12px; opacity: 0.7;">Multi-Indicator Auto Strategy</div>
    </div>

    <div class="box">
        <div class="status-bar">
            <span>Status: <b id="botStatus" style="color:#ef4444;">OFFLINE</b></span>
            <span>Target: <b style="color:#22c55e;">$50.00</b></span>
        </div>
        <div id="signalDisplay" class="signal" style="background: #020617;">âšª WAIT</div>
        <div id="confidenceBox" style="text-align: center; font-size: 14px; margin-top: 5px;">Confidence: 0%</div>
    </div>

    <div class="box">
        <div style="font-size: 13px; margin-bottom: 5px;">ðŸ“ˆ Market Sentiment (Real-time)</div>
        <canvas id="liveChart"></canvas>
        <div class="indicator-grid">
            <div class="ind-item" id="indMA">MA: --</div>
            <div class="ind-item" id="indRSI">RSI: --</div>
            <div class="ind-item" id="indBB">BB: --</div>
            <div class="ind-item" id="indStoch">Stoch: --</div>
        </div>
    </div>

    <div class="box">
        <button class="btn-start" onclick="toggleBot()" id="btnMain">AKTIFKAN CLOUD TRADING</button>
        <div class="log-box" id="logContent">> System Ready...</div>
    </div>
</div>

<script>
    let isRunning = false;
    let prices = Array.from({length: 20}, () => 50 + Math.random() * 2);
    const logEl = document.getElementById('logContent');

    function addLog(msg) {
        const time = new Date().toLocaleTimeString();
        logEl.innerHTML += `<div>[${time}] ${msg}</div>`;
        logEl.scrollTop = logEl.scrollHeight;
    }

    function calculateTechnical() {
        let score = 0;
        let lastPrice = prices[prices.length - 1];
        
        // 1. MA (Moving Average)
        let ma = prices.reduce((a, b) => a + b) / prices.length;
        let maSignal = lastPrice > ma ? 1 : -1;
        score += maSignal;
        document.getElementById('indMA').innerText = `MA: ${maSignal > 0 ? 'BULL' : 'BEAR'}`;

        // 2. RSI (Simplified)
        let rsi = 40 + Math.random() * 20; // Simulasi RSI
        if (lastPrice > 51.5) rsi += 15;
        if (lastPrice < 49.5) rsi -= 15;
        document.getElementById('indRSI').innerText = `RSI: ${rsi.toFixed(1)}`;
        if (rsi < 30) score += 2;
        if (rsi > 70) score -= 2;

        // 3. Bollinger Bands
        let bbStatus = "MID";
        if (lastPrice > 51.8) { score -= 1; bbStatus = "UPPER"; }
        if (lastPrice < 48.8) { score += 1; bbStatus = "LOWER"; }
        document.getElementById('indBB').innerText = `BB: ${bbStatus}`;

        // 4. Stochastic
        let stoch = Math.random() * 100;
        document.getElementById('indStoch').innerText = `Stoch: ${stoch.toFixed(0)}`;
        if (stoch < 20) score += 1;
        if (stoch > 80) score -= 1;

        return { score, rsi };
    }

    function updateLogic() {
        if (!isRunning) return;

        // Simulasi pergerakan harga
        let change = (Math.random() - 0.5) * 0.5;
        prices.push(prices[prices.length - 1] + change);
        prices.shift();
        drawChart();

        const analysis = calculateTechnical();
        const conf = Math.min(98, Math.abs(analysis.score) * 20 + 40);
        document.getElementById('confidenceBox').innerText = `Confidence: ${conf}%`;

        const sigEl = document.getElementById('signalDisplay');
        if (analysis.score >= 2 && conf > 75) {
            sigEl.innerText = "ðŸŸ¢ BUY";
            sigEl.style.background = "#065f46";
            addLog("Sinyal BUY kuat. Mengirim perintah ke Cloud...");
            executeGitHubAction("BUY");
        } else if (analysis.score <= -2 && conf > 75) {
            sigEl.innerText = "ðŸ”´ SELL";
            sigEl.style.background = "#7f1d1d";
            addLog("Sinyal SELL kuat. Mengirim perintah ke Cloud...");
            executeGitHubAction("SELL");
        } else {
            sigEl.innerText = "âšª WAIT";
            sigEl.style.background = "#020617";
        }
    }

    async function executeGitHubAction(type) {
        // Logika ini akan memanggil GitHub Actions via API
        // Memerlukan GITHUB_TOKEN di masa depan
        console.log(`Executing ${type} on Cloud...`);
    }

    function toggleBot() {
        isRunning = !isRunning;
        const btn = document.getElementById('btnMain');
        const status = document.getElementById('botStatus');
        
        if (isRunning) {
            btn.innerText = "BERHENTI TRADING";
            btn.style.background = "#dc2626";
            status.innerText = "ONLINE (CLOUD)";
            status.style.color = "#22c55e";
            addLog("Bot Aktif. Memulai analisis pasar...");
        } else {
            btn.innerText = "AKTIFKAN CLOUD TRADING";
            btn.style.background = "#2563eb";
            status.innerText = "OFFLINE";
            status.style.color = "#ef4444";
            addLog("Bot dimatikan.");
        }
    }

    function drawChart() {
        const c = document.getElementById('liveChart');
        const ctx = c.getContext('2d');
        ctx.clearRect(0,0,c.width,c.height);
        ctx.strokeStyle = "#3b82f6";
        ctx.lineWidth = 2;
        ctx.beginPath();
        prices.forEach((p, i) => {
            let x = i * (c.width / (prices.length - 1));
            let y = c.height - (p - 48) * 20;
            if (i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        });
        ctx.stroke();
    }

    setInterval(updateLogic, 3000);
    drawChart();
</script>
</body>
</html>
